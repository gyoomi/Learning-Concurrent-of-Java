# 超大数据量Excel导入和导出（支持10万+）

## 一、现状

假设我们的测试或生产环境的内存条件有限，比如说2GB（当然小数据的导入和导出不在本文的讨论范围，因为导入和导出它们几乎不存在内存溢出问题）。

这里，我们假如：项目中有50W条及以上数据需要进行excel导入和导出。使用普通的POI包中`HSSFWorkbook`(2003版及以前的版本)和`XSSFWorkbook`(2007版及以后的版本)，
很容易造成内存溢出，从而`无法实现`正确的`导入`和`导出`功能。

这个时候我们应该应该怎么办呢？

- 增加测试或生产环境的内存大小，比如说分配100GB甚至是更大的内存
- 使用POI的事件驱动模式实现消耗较低地内存大小实现导入10w、50w、甚至更多的数据

当然本文主要探讨的是**第二种方案的实现及细节问题**。第一个解决方案往往因为我们的客观限制并不是那么容易实现，所以我个人也比较推荐遇到这类问题，使用
第二种方法解决此类问题。

## 二、导入

## 三、导出

## 四、总结